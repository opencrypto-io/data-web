{"version":3,"sources":["index.js"],"names":["client","ocd","Client","dataUrl","defs","Projects","model","path","Assets","Networks","Exchanges","Clients","Apps","counts","contributors","formattedSource","sampleSource","sampleSourceProject","format","metadata","sampleId","query","exampleIds","project","asset","network","exchange","market","Counter","oninit","Object","keys","forEach","d","cd","view","map","col","m","style","Contributors","request","url","then","res","slice","length","href","c","html_url","src","avatar_url","login","setFormat","type","formatSource","setQuery","q","redrawSource","setModel","prev","setId","split","undefined","get","e","console","error","toString","redraw","dump","JSON","stringify","jsyaml","hljs","highlightAuto","value","DataSample","oninput","withAttr","k","id","trust","name","checked","LastCommit","commit","moment","time","fromNow","mount","document","getElementById"],"mappings":"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","file":"webapp.3433705f.map","sourceRoot":"..","sourcesContent":["const client = new ocd.Client({ dataUrl: 'data.json' })\nconst defs = {\n  Projects: { model: 'project', path: \"projects[]\" },\n  Assets: { model: 'asset', path: \"projects[].assets[]\" },\n  Networks: { model: 'network', path: \"projects[].assets[].networks[]\" },\n  Exchanges: { model: 'exchange', path: \"projects[].exchanges[]\" },\n  Clients: { model: 'client', path: \"projects[].clients[]\" },\n  Apps: { model: 'app', path: \"projects[].apps[]\" }\n}\nvar counts = {}\nvar contributors = []\nvar formattedSource = null\nvar sampleSource = null\nvar sampleSourceProject = \"ethereum\"\n\nvar format = \"yaml\"\nvar metadata = null\nvar sampleId = \"ethereum\"\nvar query = \"\"\nvar model = \"project\"\nvar exampleIds = {\n  project: \"ethereum\",\n  asset: \"ethereum:eth\",\n  network: \"ethereum:eth:main\",\n  exchange: \"makerdao:oasis\",\n  market: \"makerdao:oasis:market\"\n}\n\nvar Counter = {\n  oninit: async function() {\n    Object.keys(defs).forEach(async function(d) {\n      let cd = defs[d]\n      if (!cd.path) {\n        counts[d] = 0\n        return null\n      }\n      counts[d] = await client.query(cd.path + \" | length(@)\")\n    })\n  },\n  view: function() {\n    return Object.keys(defs).map(function(col) {\n      return m(\".tile.is-parent\",\n        m(\"article.tile.is-child.box.has-text-centered\", [\n          m(\"span.col\", \"\" + col),\n          m(\"div.count\", counts[col] || m(\"span\", { style: \"color: gray;\" }, \"?\"))\n        ])\n      )\n    })\n  }\n}\nvar Contributors = {\n  oninit: function() {\n    contributors = []\n    return m.request({\n      url: \"contributors.json\"\n    }).then(function(res) {\n      contributors = res.slice(0, 40)\n    })\n  },\n  view: function() {\n    if (contributors.length === 0) return m(\"div\", \"Loading GitHub data ..\");\n    return m(\"div\", [\n      m(\"p.title.is-4\", [\n        m(\"b\",m(\"a.silent-link\", { href: \"https://github.com/opencrypto-io/data/graphs/contributors\"}, \"Contributors\")),\n        \" - \" + contributors.length + \" people\"\n      ]),\n      m(\"div.content\", contributors.map(function(c) {\n        return m(\"a.contributor\", { href: c.html_url },\n          m(\"img.avatar\", { src: c.avatar_url }, c.login))\n      }))\n    ])\n  }\n}\nfunction setFormat(type) {\n  format = type\n  formatSource(sampleSource)\n}\nasync function setQuery(q) {\n  query = q\n  redrawSource()\n}\nasync function setModel(q, prev) {\n  model = q\n  if (q !== prev) {\n    return setId(exampleIds[q])\n  }\n  redrawSource()\n}\nasync function setId(q) {\n  sampleId = q\n  sampleSourceProject = q.split(\":\")[0]\n  redrawSource()\n}\nasync function redrawSource() {\n  if (query === \"\") {\n    query = undefined\n  }\n  try {\n    sampleSource = await client.get(model, sampleId, query)\n  } catch (e) {\n    console.error(\"Query error: \" + e)\n    sampleSource = e.toString()\n  }\n  formatSource(sampleSource)\n  m.redraw()\n}\nfunction formatSource(res) {\n  let dump = null\n  if (format === \"json\") {\n    dump = JSON.stringify(res, null, 2)\n  } else {\n    dump = jsyaml.dump(res)\n  }\n  formattedSource = hljs.highlightAuto(dump).value\n}\nvar DataSample = {\n  oninit: async function() {\n    redrawSource()\n    //m.redraw()\n  },\n  view: function() {\n    return m(\"div\", [\n      m(\"div\", [\n        m(\".level\", { style: \"margin-bottom: 0.7em;\" }, [\n          m('.level-item', [\n            m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Model: \"),\n            m(\".select\", m(\"select\", { type: \"text\", value: model, oninput: m.withAttr(\"value\", setModel), style: \"background-color: rgba(255, 255, 255, 0.3); border: none;\" }, Object.keys(defs).map(function(k) {\n              return m(\"option\", { id: defs[k].model }, defs[k].model)\n            })))\n          ]),\n          m('.level-item', [\n            m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Id: \"),\n            m(\"input.input\", { type: \"text\", value: sampleId, oninput: m.withAttr(\"value\", setId), style: \"background-color: rgba(255, 255, 255, 0.3); border: none;\" })\n          ]),\n        ]),\n        m(\".level\", { style: \"margin-bottom: 0.7em;\" }, [\n          m('.level-item', [\n            m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Query: \"),\n            m(\"input.input\", { type: \"text\", value: query, oninput: m.withAttr(\"value\", setQuery), style: \"background-color: rgba(255, 255, 255, 0.3); border: none;\" })\n          ])\n        ])\n      ]),\n      m(\"pre\", m(\"code\", m.trust(formattedSource))),\n      m(\"div\", { style: \"padding-top: 0.5em;\" }, [\n        m(\".level\", [\n          m(\".level-left\", [\n            m(\".control.level-item\", [\n              m(\"span\", \"Format: \"),\n              m(\"label.radio\", [ m(\"input\", { oninput: m.withAttr(\"value\", setFormat), type: \"radio\", name: \"format\", value: \"yaml\", checked: (format === \"yaml\") }), \" YAML\" ]),\n              m(\"label.radio\", [ m(\"input\", { oninput: m.withAttr(\"value\", setFormat), type: \"radio\", name: \"format\", value: \"json\", checked: (format === \"json\") }), \" JSON\" ])\n            ])\n          ]),\n          m(\".level-right\", [\n            m(\".level-item\", m(\"a\", { href: \"https://github.com/opencrypto-io/data/blob/master/db/projects/\"+sampleSourceProject+\"/project.yaml\", style: \"color: white;\" }, [\n              m(\"i.far.fa-file\"),\n              m(\"span\", \" Source file\")\n            ])),\n            m(\".level-item\", m(\"a\", { href: \"https://github.com/opencrypto-io/data/edit/master/db/projects/\"+sampleSourceProject+\"/project.yaml\", style: \"color: white;\" }, [\n              m(\"i.far.fa-edit\"),\n              m(\"span\", \" Edit\")\n            ])),\n          ])\n        ])\n      ])\n    ])\n  }\n}\nvar LastCommit = {\n  oninit: async function() {\n    metadata = await client.query(\"metadata\")\n    m.redraw()\n  },\n  view: function() {\n    if (!metadata) return null\n    return m(\"div\", [\n      \"Last commit: \",\n      m(\"a\", { href: \"https://github.com/opencrypto-io/data/commits/master\" }, metadata.commit),\n      \" (\" + moment(metadata.time).fromNow() + \")\"\n    ])\n  }\n}\nm.mount(document.getElementById('counters'), Counter)\nm.mount(document.getElementById('contributors'), Contributors)\nm.mount(document.getElementById('data-sample'), DataSample)\nm.mount(document.getElementById('last-commit'), LastCommit)\n"]}