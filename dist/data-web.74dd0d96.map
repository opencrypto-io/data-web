{"version":3,"sources":["index.js"],"names":["baseUrl","window","location","hostname","makeUrl","url","join","client","ocd","Client","dataUrl","defs","Projects","model","path","Assets","Networks","Exchanges","Clients","Apps","counts","contributors","formattedSource","sampleSource","sampleSourceProject","format","metadata","sampleId","query","exampleIds","project","asset","network","exchange","market","Counter","oninit","Object","keys","forEach","d","cd","view","map","col","m","style","Contributors","request","then","res","slice","length","href","c","html_url","src","avatar_url","login","setFormat","type","formatSource","setQuery","q","redrawSource","setModel","prev","setId","split","undefined","get","e","console","error","toString","redraw","dump","JSON","stringify","jsyaml","hljs","highlight","value","DataSample","oninput","withAttr","k","id","placeholder","trust","onclick","name","class","LastCommit","commitShort","commit","replace","title","moment","time","fromNow","mount","document","getElementById"],"mappings":"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","file":"data-web.74dd0d96.map","sourceRoot":"..","sourcesContent":["\nvar baseUrl = ''\nif (window.location.hostname === 'localhost') {\n  baseUrl = 'https://data.opencrypto.io/'\n}\n\nfunction makeUrl(url) {\n  return [ baseUrl, url ].join('/')\n}\n\nconst client = new ocd.Client({ dataUrl: makeUrl('data.json') })\nconst defs = {\n  Projects: { model: 'project', path: \"projects[]\" },\n  Assets: { model: 'asset', path: \"projects[].assets[]\" },\n  Networks: { model: 'network', path: \"projects[].assets[].networks[]\" },\n  Exchanges: { model: 'exchange', path: \"projects[].exchanges[]\" },\n  Clients: { model: 'client', path: \"projects[].clients[]\" },\n  Apps: { model: 'app', path: \"projects[].apps[]\" }\n}\nvar counts = {}\nvar contributors = []\nvar formattedSource = null\nvar sampleSource = null\nvar sampleSourceProject = \"ethereum\"\n\nvar format = \"yaml\"\nvar metadata = null\nvar sampleId = \"ethereum\"\nvar query = \"\"\nvar model = \"project\"\nvar exampleIds = {\n  project: \"ethereum\",\n  asset: \"ethereum:eth\",\n  network: \"ethereum:eth:main\",\n  exchange: \"makerdao:oasis\",\n  market: \"makerdao:oasis:market\"\n}\n\nvar Counter = {\n  oninit: async function() {\n    Object.keys(defs).forEach(async function(d) {\n      let cd = defs[d]\n      if (!cd.path) {\n        counts[d] = 0\n        return null\n      }\n      counts[d] = await client.query(cd.path + \" | length(@)\")\n    })\n  },\n  view: function() {\n    return Object.keys(defs).map(function(col) {\n      return m(\".tile.is-parent\",\n        m(\"article.tile.is-child.has-text-centered\", [\n          m(\"span.col\", \"# \" + col),\n          m(\"div.count\", counts[col] || m(\"span\", { style: \"color: gray;\" }, \"?\"))\n        ])\n      )\n    })\n  }\n}\nvar Contributors = {\n  oninit: function() {\n    contributors = []\n    return m.request({\n      url: makeUrl(\"contributors.json\")\n    }).then(function(res) {\n      contributors = res.slice(0, 40)\n    })\n  },\n  view: function() {\n    if (contributors.length === 0) return m(\"div\", \"Loading GitHub data ..\");\n    return m(\"div\", [\n      m(\"p.title.is-4\", [\n        m(\"b\",m(\"a.silent-link\", { href: \"https://github.com/opencrypto-io/data/graphs/contributors\"}, \"Contributors\")),\n        \" - \" + contributors.length + \" people\"\n      ]),\n      m(\"div.content\", contributors.map(function(c) {\n        return m(\"a.contributor\", { href: c.html_url },\n          m(\"img.avatar\", { src: c.avatar_url }, c.login))\n      }))\n    ])\n  }\n}\nfunction setFormat(type) {\n  format = type\n  formatSource(sampleSource)\n}\nasync function setQuery(q) {\n  query = q\n  redrawSource()\n}\nasync function setModel(q, prev) {\n  model = q\n  if (q !== prev) {\n    return setId(exampleIds[q])\n  }\n  redrawSource()\n}\nasync function setId(q) {\n  sampleId = q\n  sampleSourceProject = q.split(\":\")[0]\n  redrawSource()\n}\nasync function redrawSource() {\n  if (query === \"\") {\n    query = undefined\n  }\n  try {\n    sampleSource = await client.get(model, sampleId, query)\n  } catch (e) {\n    console.error(\"Query error: \" + e)\n    sampleSource = e.toString()\n  }\n  formatSource(sampleSource)\n  m.redraw()\n}\nfunction formatSource(res) {\n  let dump = null\n  let type = null\n  if (format === \"json\") {\n    dump = JSON.stringify(res, null, 2)\n    type = 'json'\n  } else {\n    dump = jsyaml.dump(res)\n    type = 'yaml'\n  }\n  formattedSource = hljs.highlight(type, dump).value\n}\nvar DataSample = {\n  oninit: async function() {\n    redrawSource()\n    //m.redraw()\n  },\n  view: function() {\n    return m(\"div\", [\n      m(\".sample-header\", [\n        m(\".sample-header-container\", [\n          m(\".level\", [\n            m('.level-item', [\n              //m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Model: \"),\n              m(\".select\", m(\"select\", { type: \"text\", value: model, oninput: m.withAttr(\"value\", setModel) }, Object.keys(defs).map(function(k) {\n                return m(\"option\", { id: defs[k].model }, defs[k].model)\n              })))\n            ]),\n            m('.level-item', [\n              //m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Id: \"),\n              m(\"input.input\", { type: \"text\", value: sampleId, oninput: m.withAttr(\"value\", setId), placeholder: 'Item ID ..' })\n            ]),\n            m('.level-item', [\n              //m(\"label\", { style: \"padding-right: 0.5em;\"}, \"Query: \"),\n              m(\"input.input\", { type: \"text\", value: query, oninput: m.withAttr(\"value\", setQuery), placeholder: 'Query ..' })\n            ])\n          ])\n        ]),\n      ]),\n      m(\"pre\", m(\"code\", m.trust(formattedSource))),\n      m(\".sample-footer\", { style: \"padding-top: 0.5em;\" }, [\n        m(\".level\", [\n          m(\".level-left\", [\n            m(\".control.level-item\", [\n              m(\"a\", { onclick: m.withAttr(\"value\", setFormat), name: \"format\", value: \"yaml\", class: (format === \"yaml\") ? 'checked' : '' }, \"YAML\"),\n              m.trust(\"&nbsp;-&nbsp;\"),\n              m(\"a\", { onclick: m.withAttr(\"value\", setFormat), name: \"format\", value: \"json\", class: (format === \"json\") ? 'checked' : '' }, \" JSON\")\n            ])\n          ]),\n          m(\".level-right\", [\n            m(\".level-item\", m(\"a\", { href: \"https://github.com/opencrypto-io/data/blob/master/db/projects/\"+sampleSourceProject+\"/project.yaml\", style: \"color: white;\" }, [\n              m(\"i.far.fa-file\"),\n              m(\"span\", \" Source file\")\n            ])),\n            m(\".level-item\", m(\"a\", { href: \"https://github.com/opencrypto-io/data/edit/master/db/projects/\"+sampleSourceProject+\"/project.yaml\", style: \"color: white;\" }, [\n              m(\"i.far.fa-edit\"),\n              m(\"span\", \" Edit\")\n            ])),\n          ])\n        ])\n      ])\n    ])\n  }\n}\nvar LastCommit = {\n  oninit: async function() {\n    metadata = await client.query(\"metadata\")\n    m.redraw()\n  },\n  view: function() {\n    if (!metadata) return null\n    let commitShort = metadata.commit.replace(/^(.{7}).+(.{7})$/, \"$1\")\n    return m(\"div\", [\n      m(\"div.is-hidden-mobile\", \"Last commit: \"),\n      m(\"a\", { href: \"https://github.com/opencrypto-io/data/commits/master\", title: metadata.commit }, commitShort),\n      m(\"span\", \" (\"+moment(metadata.time).fromNow()+\")\")\n    ])\n  }\n}\nm.mount(document.getElementById('counters'), Counter)\nm.mount(document.getElementById('contributors'), Contributors)\nm.mount(document.getElementById('data-sample'), DataSample)\nm.mount(document.getElementById('last-commit'), LastCommit)\n"]}